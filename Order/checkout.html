<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout - MyCart</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      padding: 20px;
    }

    h2 {
      text-align: center;
      color: #5c0b7a;
    }

    .section {
      margin-top: 30px;
    }

    .section h3 {
      margin-bottom: 10px;
      color: #333;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }

    input[type="text"], input[type="number"], input[type="tel"] {
      width: 100%;
      padding: 10px;
      margin: 5px 0 15px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .payment-methods label {
      display: block;
      margin-bottom: 10px;
    }

    .order-summary {
      background: #fafafa;
      padding: 15px;
      border-radius: 6px;
    }

    .cart-items {
      margin-bottom: 15px;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .cart-item img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 6px;
      margin-right: 10px;
    }

    .cart-item-details {
      flex-grow: 1;
    }

    .btn {
      width: 100%;
      padding: 12px;
      background-color: #6a0dad;
      color: white;
      border: none;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
    }

    .btn:hover {
      background-color: #500e9c;
    }

    .total {
      font-weight: bold;
      color: #111;
    }

    .confirmation {
      display: none;
      background-color: #d4edda;
      padding: 50px 30px;
      border-radius: 12px;
      text-align: center;
      margin-top: 50px;
    }

    .confirmation h1 {
      color: #155724;
    }

    .confirmation .emoji {
      font-size: 40px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<div class="container" id="checkout-section">
  <h2>üõí Checkout</h2>

  <!-- Address Section -->
  <div class="section">
    <h3>1. Delivery Address</h3>
    <input type="text" id="name" placeholder="Full Name" required>
    <input type="tel" id="phone" placeholder="Phone Number (10 digits)" maxlength="10" required>
    <input type="text" id="house" placeholder="Flat / House No." required>
    <input type="text" id="street" placeholder="Street / Locality" required>
    <input type="text" id="city" placeholder="City" required>
    <input type="text" id="state" placeholder="State" required>
    <input type="text" id="pincode" placeholder="Pincode (6 digits)" maxlength="6" required>
  </div>

  <!-- Payment Section -->
  <div class="section">
    <h3>2. Payment Method</h3>
    <div class="payment-methods">
      <label><input type="radio" name="payment" value="UPI" checked onchange="togglePaymentFields()"> UPI</label>
      <label><input type="radio" name="payment" value="Cash on Delivery" onchange="togglePaymentFields()"> Cash on Delivery</label>
      <label><input type="radio" name="payment" value="Credit/Debit Card" onchange="togglePaymentFields()"> Credit/Debit Card</label>
    </div>

    <div id="upi-field">
      <input type="text" id="upi-id" placeholder="Enter your UPI ID">
    </div>

    <div id="card-fields" style="display:none;">
      <input type="text" id="card-number" placeholder="Card Number">
      <input type="text" id="expiry" placeholder="MM/YY">
      <input type="text" id="cvv" placeholder="CVV">
    </div>
  </div>

  <!-- Order Summary -->
  <div class="section order-summary">
    <h3>3. Order Summary</h3>
    <div class="cart-items" id="cart-items"></div>
    <p class="total">Grand Total: ‚Çπ<span id="grand-total">0</span></p>
  </div>

  <button class="btn" onclick="placeOrder()">Place Order</button>
</div>

<!-- Confirmation -->
<div class="container confirmation" id="confirmation-section">
  <div class="emoji">üéâ</div>
  <h1>Your order has been placed!</h1>
  <p>Thank you for shopping with us. We‚Äôll deliver your order soon.</p>
</div>

<script>
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const cartContainer = document.getElementById("cart-items");
  const grandTotalEl = document.getElementById("grand-total");

  function renderCart() {
    let total = 0;
    cartContainer.innerHTML = "";

    if (cart.length === 0) {
      cartContainer.innerHTML = "<p>Your cart is currently empty.</p>";
      grandTotalEl.textContent = "0";
      return;
    }

    cart.forEach(item => {
      const itemTotal = item.price * item.quantity;
      total += itemTotal;

      const div = document.createElement("div");
      div.classList.add("cart-item");
      div.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <div class="cart-item-details">
          <strong>${item.name}</strong><br>
          ‚Çπ${item.price} x ${item.quantity}
        </div>
        <div>‚Çπ${itemTotal}</div>
      `;
      cartContainer.appendChild(div);
    });

    grandTotalEl.textContent = total;
  }

  renderCart();

  function togglePaymentFields() {
    const selected = document.querySelector('input[name="payment"]:checked').value;
    document.getElementById("upi-field").style.display = selected === "UPI" ? "block" : "none";
    document.getElementById("card-fields").style.display = selected === "Credit/Debit Card" ? "block" : "none";
  }

  function placeOrder() {
    if (cart.length === 0) {
      alert("üõí Your cart is empty!");
      return;
    }

    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const house = document.getElementById("house").value.trim();
    const street = document.getElementById("street").value.trim();
    const city = document.getElementById("city").value.trim();
    const state = document.getElementById("state").value.trim();
    const pincode = document.getElementById("pincode").value.trim();
    const paymentMethod = document.querySelector('input[name="payment"]:checked').value;

    if (!name || !phone || !house || !street || !city || !state || !pincode) {
      alert("‚ùó Please fill in all delivery details.");
      return;
    }

    if (paymentMethod === "UPI" && !document.getElementById("upi-id").value.trim()) {
      alert("‚ö†Ô∏è Please enter your UPI ID.");
      return;
    }

    if (paymentMethod === "Credit/Debit Card") {
      const cardNumber = document.getElementById("card-number").value.trim();
      const expiry = document.getElementById("expiry").value.trim();
      const cvv = document.getElementById("cvv").value.trim();
      if (!cardNumber || !expiry || !cvv) {
        alert("‚ö†Ô∏è Please enter all card details.");
        return;
      }
    }

    const orderId = "ORD" + Math.floor(Math.random() * 1000000);
    localStorage.setItem("lastOrderId", orderId);

    const orderDetails = {
      orderId,
      products: cart,
      customer: { name, phone, house, street, city, state, pincode },
      paymentMethod
    };
    localStorage.setItem("orderDetails", JSON.stringify(orderDetails));

    localStorage.removeItem("cart");

    document.getElementById("checkout-section").style.display = "none";
    document.getElementById("confirmation-section").style.display = "block";
    document.body.style.backgroundColor = "#d4edda";

    // Add order ID to confirmation message
    document.getElementById("confirmation-section").innerHTML += `
      <p style="margin-top:10px;color:#333;"><strong>Order ID:</strong> ${orderId}</p>
    `;

    // Redirect to tracking page after 2 seconds
    setTimeout(() => {
      window.location.href = "track.html";
    }, 2000);
  }
</script>

</body>
</html>
